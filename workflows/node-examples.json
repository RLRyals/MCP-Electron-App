{
  "_comment": "Enhanced Node Examples for 12-Phase Novel Series Workflow",
  "_description": "This file shows example configurations for each node type used in the workflow",

  "userInputNodeExample": {
    "id": "node-0",
    "name": "Book/Series Idea Capture",
    "description": "Capture the author's initial book or series idea",
    "type": "user-input",
    "position": { "x": 100, "y": 50 },

    "prompt": "Please describe your book or series idea. Include genre, main character concept, setting, and any key plot points or themes you have in mind.",
    "inputType": "textarea",
    "required": true,
    "validation": {
      "minLength": 50,
      "maxLength": 5000
    },
    "defaultValue": "",

    "requiresApproval": false,
    "contextConfig": {
      "mode": "simple"
    }
  },

  "planningAgentNodeExample": {
    "id": "node-1",
    "name": "Market Research",
    "description": "Research current urban fantasy market trends",
    "type": "planning",
    "position": { "x": 100, "y": 200 },

    "provider": {
      "type": "claude-code-cli",
      "name": "Claude Code CLI (Default)",
      "config": {
        "model": "claude-sonnet-4-5",
        "outputFormat": "json"
      }
    },

    "agent": "market-research-agent",
    "skill": "urban-fantasy-market-analysis",
    "gate": false,

    "requiresApproval": false,
    "retryConfig": {
      "maxRetries": 3,
      "retryDelayMs": 1000,
      "backoffMultiplier": 2
    },
    "timeoutMs": 300000,
    "contextConfig": {
      "mode": "simple"
    }
  },

  "gateNodeExample": {
    "id": "node-4",
    "name": "NPE Validation",
    "description": "Validate planning quality using NPE checklist",
    "type": "gate",
    "position": { "x": 100, "y": 650 },

    "provider": {
      "type": "claude-code-cli",
      "name": "Claude Code CLI (Default)",
      "config": {
        "model": "claude-sonnet-4-5",
        "outputFormat": "json"
      }
    },

    "agent": "npe-validator-agent",
    "skill": "validate-novel-structure",
    "gate": true,
    "gateCondition": "$.score >= 80",

    "requiresApproval": true,
    "retryConfig": {
      "maxRetries": 5,
      "retryDelayMs": 2000,
      "backoffMultiplier": 1.5
    },
    "timeoutMs": 180000,
    "contextConfig": {
      "mode": "simple"
    }
  },

  "loopNodeExample": {
    "id": "node-5",
    "name": "Chapter Writing Loop",
    "description": "Iteratively write each chapter of Book 1",
    "type": "loop",
    "position": { "x": 100, "y": 800 },

    "loopType": "forEach",
    "collection": "$.book1Planning.chapters",
    "iteratorVariable": "currentChapter",
    "indexVariable": "chapterIndex",
    "maxIterations": 50,

    "requiresApproval": false,
    "timeoutMs": 600000,
    "contextConfig": {
      "mode": "simple"
    },

    "_loopBodyComment": "Loop body would contain child nodes for chapter writing",
    "_loopBodyExample": {
      "childNode": {
        "type": "writing",
        "agent": "chapter-writer-agent",
        "skill": "chapter-writing",
        "contextConfig": {
          "mode": "advanced",
          "inputs": [
            {
              "source": "$.currentChapter.outline",
              "target": "chapterOutline"
            },
            {
              "source": "$.currentChapter.sceneCards",
              "target": "sceneCards"
            },
            {
              "source": "$.characterProfiles",
              "target": "characters"
            }
          ],
          "outputs": [
            {
              "source": "chapterText",
              "target": "$.completedChapters[{{chapterIndex}}]"
            }
          ]
        }
      }
    }
  },

  "fileWriteNodeExample": {
    "id": "node-6",
    "name": "Manuscript Assembly",
    "description": "Assemble all chapters into complete manuscript",
    "type": "file",
    "position": { "x": 100, "y": 950 },

    "operation": "write",
    "targetPath": "{{projectFolder}}/Book1_Manuscript.txt",
    "content": "{{assembledManuscript}}",
    "encoding": "utf8",
    "overwrite": true,
    "requireProjectFolder": true,

    "requiresApproval": false,
    "retryConfig": {
      "maxRetries": 3,
      "retryDelayMs": 1000,
      "backoffMultiplier": 2
    },
    "contextConfig": {
      "mode": "simple"
    },

    "_contentSourceComment": "Content comes from workflow context variable {{assembledManuscript}}",
    "_contentSourceExample": {
      "contextVariable": "assembledManuscript",
      "generatedBy": "manuscript-assembler-agent in previous step",
      "format": "Plain text with chapter headers"
    }
  },

  "fileCopyNodeExample": {
    "id": "node-10",
    "name": "Export for Publication",
    "description": "Copy final manuscript to export folder",
    "type": "file",
    "position": { "x": 100, "y": 1550 },

    "operation": "copy",
    "sourcePath": "{{projectFolder}}/Book1_Manuscript.txt",
    "targetPath": "{{projectFolder}}/exports/Book1_Final.txt",
    "requireProjectFolder": true,

    "requiresApproval": false,
    "retryConfig": {
      "maxRetries": 3,
      "retryDelayMs": 1000,
      "backoffMultiplier": 2
    },
    "contextConfig": {
      "mode": "simple"
    }
  },

  "conditionalNodeExample": {
    "id": "node-11",
    "name": "Series Progression Check",
    "description": "Check if more books need to be written",
    "type": "conditional",
    "position": { "x": 100, "y": 1700 },

    "condition": "$.currentBookNumber < 5",
    "conditionType": "jsonpath",

    "requiresApproval": false,
    "contextConfig": {
      "mode": "simple"
    },

    "_branchingComment": "Edges define what happens on true vs false",
    "_edgeExamples": [
      {
        "id": "e11-3",
        "source": "node-11",
        "target": "node-3",
        "type": "conditional",
        "label": "currentBookNumber < 5 (next book)",
        "condition": "true"
      },
      {
        "id": "e11-12",
        "source": "node-11",
        "target": "node-12",
        "type": "conditional",
        "label": "currentBookNumber >= 5 (complete)",
        "condition": "false"
      }
    ]
  },

  "advancedContextMappingExample": {
    "_comment": "This shows how to use advanced context mode for explicit variable mapping",
    "_nodeExample": {
      "id": "node-example",
      "name": "Advanced Context Example",
      "type": "writing",

      "contextConfig": {
        "mode": "advanced",
        "inputs": [
          {
            "source": "$.marketResearch.topTropes",
            "target": "trendingTropes",
            "transform": "x => x.slice(0, 5)"
          },
          {
            "source": "$.seriesBible.protagonistArc",
            "target": "mainCharacterArc"
          },
          {
            "source": "$.currentBookNumber",
            "target": "bookNumber"
          }
        ],
        "outputs": [
          {
            "source": "generatedOutline",
            "target": "$.bookPlanning.outline"
          },
          {
            "source": "chapterList",
            "target": "$.bookPlanning.chapters"
          }
        ]
      }
    },

    "_explanation": {
      "inputs": "Map data from workflow context into node's input variables",
      "outputs": "Map node's output variables back into workflow context",
      "transform": "Optional JavaScript function to transform data",
      "jsonPath": "Use JSONPath expressions to navigate context tree"
    }
  },

  "alternativeLLMProviderExamples": {
    "_comment": "Examples of different LLM provider configurations",

    "claudeAPI": {
      "type": "claude-api",
      "name": "My Claude API Key",
      "config": {
        "apiKey": "sk-ant-...",
        "model": "claude-sonnet-4-5",
        "maxTokens": 4096,
        "temperature": 0.7
      }
    },

    "openAI": {
      "type": "openai",
      "name": "OpenAI GPT-4",
      "config": {
        "apiKey": "sk-...",
        "model": "gpt-4o",
        "maxTokens": 4096,
        "temperature": 0.7
      }
    },

    "googleGemini": {
      "type": "google",
      "name": "Google Gemini Pro",
      "config": {
        "apiKey": "AIza...",
        "model": "gemini-1.5-pro",
        "maxTokens": 4096,
        "temperature": 0.7
      }
    },

    "localLLM": {
      "type": "local",
      "name": "Local Ollama",
      "config": {
        "endpoint": "http://localhost:11434",
        "model": "llama2",
        "apiFormat": "ollama",
        "maxTokens": 4096,
        "temperature": 0.7
      }
    }
  },

  "edgeExamples": {
    "_comment": "Examples of different edge types connecting nodes",

    "sequentialEdge": {
      "id": "e0-1",
      "source": "node-0",
      "target": "node-1",
      "type": "sequential",
      "_description": "Simple sequential flow from one node to the next"
    },

    "conditionalEdge": {
      "id": "e4-5",
      "source": "node-4",
      "target": "node-5",
      "type": "conditional",
      "label": "score >= 80 (pass)",
      "condition": "$.score >= 80",
      "_description": "Conditional flow based on gate condition"
    },

    "loopBackEdge": {
      "id": "e4-3",
      "source": "node-4",
      "target": "node-3",
      "type": "conditional",
      "label": "score < 80 (retry)",
      "condition": "$.score < 80",
      "_description": "Loop back to earlier phase when gate fails"
    },

    "loopEdge": {
      "id": "e5-loop",
      "source": "node-5",
      "target": "node-5-body",
      "type": "loop",
      "_description": "Edge from loop node to its body (child nodes)"
    }
  },

  "workflowContextExample": {
    "_comment": "Example of what the workflow context looks like during execution",
    "_exampleContext": {
      "userIdea": "Urban fantasy series about Maya Chen, a Chinese-American demon hunter...",

      "marketResearch": {
        "compTitles": [
          "The Dresden Files by Jim Butcher",
          "Kate Daniels series by Ilona Andrews",
          "October Daye series by Seanan McGuire"
        ],
        "trendingTropes": [
          "Strong female protagonist",
          "Urban setting with hidden magical world",
          "Slow-burn romance",
          "Found family dynamics"
        ],
        "targetAudience": {
          "age": "25-45",
          "gender": "70% female",
          "interests": ["fantasy", "urban fantasy", "paranormal romance"]
        }
      },

      "seriesBible": {
        "books": [
          {
            "bookNumber": 1,
            "title": "Shadow Hunter",
            "summary": "Maya discovers her heritage and must stop a demon invasion..."
          },
          {
            "bookNumber": 2,
            "title": "Blood Oath",
            "summary": "Maya forms alliances and confronts a vampire conspiracy..."
          }
        ],
        "protagonistArc": "From reluctant outsider to confident leader of supernatural alliance",
        "worldProgression": "Gradual revelation of hidden magical hierarchy in San Francisco"
      },

      "currentBookNumber": 1,

      "book1Planning": {
        "outline": "3-act structure with 28 chapters...",
        "chapters": [
          {
            "chapterNumber": 1,
            "title": "The First Hunt",
            "outline": "Maya encounters her first demon in a dark alley...",
            "sceneCards": [
              "Scene 1: Corporate office, day job",
              "Scene 2: Late night phone call",
              "Scene 3: Demon encounter in alley"
            ],
            "wordCount": 3500
          }
        ]
      },

      "npeValidation": {
        "score": 85,
        "passed": true,
        "issues": [],
        "recommendations": ["Consider strengthening the B-plot"]
      },

      "completedChapters": [
        {
          "chapterNumber": 1,
          "text": "Maya Chen stared at the spreadsheet on her dual monitors...",
          "wordCount": 3542,
          "timestamp": "2025-12-20T10:30:00Z"
        }
      ],

      "manuscriptPath": "/project/Book1_Manuscript.txt",
      "manuscriptWordCount": 92000,

      "devEditReport": {
        "structuralIssues": [],
        "pacingNotes": "Consider tightening chapters 12-15",
        "characterNotes": "Love interest needs more development in act 2"
      },

      "readiness": 94,
      "exportPaths": [
        "/project/exports/Book1_Final.txt",
        "/project/exports/Book1_Final.docx",
        "/project/exports/Book1_Final.pdf"
      ]
    }
  },

  "executionFlowExample": {
    "_comment": "Example showing how the workflow executor processes nodes",
    "_steps": [
      {
        "step": 1,
        "action": "Execute Node 0 (User Input)",
        "input": "User provides book idea via textarea",
        "output": "$.userIdea = 'Urban fantasy series about...'",
        "nextNode": "node-1"
      },
      {
        "step": 2,
        "action": "Execute Node 1 (Market Research)",
        "input": "Simple mode: receives $.userIdea automatically",
        "llmCall": "market-research-agent with urban-fantasy-market-analysis skill",
        "output": "$.marketResearch = { compTitles: [...], trendingTropes: [...] }",
        "nextNode": "node-2"
      },
      {
        "step": 3,
        "action": "Execute Node 2 (Series Architecture)",
        "input": "Simple mode: receives $.userIdea + $.marketResearch",
        "llmCall": "series-architect-agent with five-book-series-planning skill",
        "output": "$.seriesBible = { books: [...], protagonistArc: '...' }",
        "approval": "PENDING - Waiting for user to review series plan",
        "nextNode": "Wait for approval"
      },
      {
        "step": 4,
        "action": "User Approves Series Plan",
        "approval": "APPROVED",
        "nextNode": "node-3"
      },
      {
        "step": 5,
        "action": "Execute Node 3 (Book 1 Planning)",
        "input": "Simple mode: receives $.seriesBible + $.marketResearch",
        "llmCall": "book-planner-agent with detailed-book-planning skill",
        "output": "$.book1Planning = { outline: '...', chapters: [...] }",
        "approval": "PENDING - Waiting for user to review book outline",
        "nextNode": "Wait for approval"
      },
      {
        "step": 6,
        "action": "User Approves Book Outline",
        "approval": "APPROVED",
        "nextNode": "node-4"
      },
      {
        "step": 7,
        "action": "Execute Node 4 (NPE Validation Gate)",
        "input": "Simple mode: receives $.book1Planning",
        "llmCall": "npe-validator-agent with validate-novel-structure skill",
        "output": "$.npeValidation = { score: 85, passed: true }",
        "gateCheck": "score >= 80 ? PASS",
        "approval": "PENDING - Waiting for user to review validation",
        "nextNode": "Wait for approval"
      },
      {
        "step": 8,
        "action": "User Approves NPE Validation",
        "approval": "APPROVED",
        "gateResult": "PASS",
        "nextNode": "node-5"
      },
      {
        "step": 9,
        "action": "Execute Node 5 (Chapter Writing Loop)",
        "loopType": "forEach",
        "collection": "$.book1Planning.chapters (28 chapters)",
        "iterations": [
          {
            "iteration": 1,
            "currentChapter": "$.book1Planning.chapters[0]",
            "chapterIndex": 0,
            "llmCall": "chapter-writer-agent with chapter-writing skill",
            "output": "$.completedChapters[0] = { chapterNumber: 1, text: '...', wordCount: 3542 }"
          },
          {
            "iteration": 2,
            "currentChapter": "$.book1Planning.chapters[1]",
            "chapterIndex": 1,
            "llmCall": "chapter-writer-agent with chapter-writing skill",
            "output": "$.completedChapters[1] = { chapterNumber: 2, text: '...', wordCount: 3401 }"
          },
          "... (continues for all 28 chapters)"
        ],
        "nextNode": "node-6"
      },
      {
        "step": 10,
        "action": "Execute Node 6 (Manuscript Assembly)",
        "fileOperation": "write",
        "targetPath": "/project/Book1_Manuscript.txt",
        "content": "Assembled from $.completedChapters array",
        "result": "File written successfully, 92000 words",
        "output": "$.manuscriptPath = '/project/Book1_Manuscript.txt'",
        "nextNode": "node-7"
      }
    ]
  }
}
